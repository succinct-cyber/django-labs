<!DOCTYPE html>
<html>
<head>
    <title>Product List</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; }
        .card {
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            width: 220px;
            text-align: center;
        }
        img { width: 200px; height: 200px; object-fit: cover; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>NFT Collection</h1>
    <div class="container">
        {% for product in products %}
        <div class="card">
            {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}">
            {% endif %}
            <h3>{{ product.name }}</h3>
            <p><strong>${{ product.price }}</strong></p>
            <p>{{ product.description }}</p>
            <small>Category: {{ product.category.name }}</small>
        </div>
        {% endfor %}
    </div>
</body>
</html>
<script src="https://cdn.jsdelivr.net/npm/web3@1.9.0/dist/web3.min.js"></script>

<button id="connectWallet">Connect Wallet</button>
<p id="walletAddress"></p>

<script>
  const connectButton = document.getElementById('connectWallet');
  const walletDisplay = document.getElementById('walletAddress');

  connectButton.onclick = async () => {
    if (window.ethereum) {
      try {
        const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
        const account = accounts[0];
        walletDisplay.innerText = `Connected: ${account}`;
      } catch (err) {
        console.error("User rejected connection", err);
      }
    } else {
      alert("Please install MetaMask!");
    }
  };
</script>
<div id="nftGallery"></div>

<script>
  const nftContractAddress = "0xYourNFTContractAddress";
  const nftABI = [ /* ABI JSON here */ ];

  async function loadNFTs() {
    if (!window.ethereum) return;

    const web3 = new Web3(window.ethereum);
    const contract = new web3.eth.Contract(nftABI, nftContractAddress);

    const totalSupply = await contract.methods.totalSupply().call();
    const gallery = document.getElementById('nftGallery');

    for (let i = 0; i < totalSupply; i++) {
      const tokenURI = await contract.methods.tokenURI(i).call();
      const response = await fetch(tokenURI);
      const metadata = await response.json();

      const nftDiv = document.createElement('div');
      nftDiv.innerHTML = `
        <img src="${metadata.image}" alt="${metadata.name}" width="200">
        <p>${metadata.name}</p>
      `;
      gallery.appendChild(nftDiv);
    }
  }

  loadNFTs();
</script>
<button id="mintNFT">Mint NFT</button>

<script>
  const mintButton = document.getElementById('mintNFT');

  mintButton.onclick = async () => {
    const web3 = new Web3(window.ethereum);
    const contract = new web3.eth.Contract(nftABI, nftContractAddress);

    const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
    const account = accounts[0];

    try {
      await contract.methods.mint().send({ from: account, value: web3.utils.toWei("0.05", "ether") });
      alert("NFT minted successfully!");
      loadNFTs(); // refresh gallery
    } catch (err) {
      console.error(err);
      alert("Mint failed");
    }
  };
</script>
<script>
  async function connectWallet() {
    if (window.ethereum) {
      const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
      const account = accounts[0];
      console.log("Connected wallet:", account);

      // Paste here üëáüèΩ
      fetch('/register_wallet/', {
        method: 'POST',
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: `address=${account}`
      });
    } else {
      alert("Please install MetaMask!");
    }
  }
</script>
<button onclick="connectWallet()">Connect Wallet</button>
fetch('/register_wallet/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/x-www-form-urlencoded',
    'X-CSRFToken': csrftoken
  },
  body: `address=${account}`
});
{% for nft in nfts %}
  <div>
    <img src="{{ nft.image }}" alt="{{ nft.name }}" width="200">
    <p>{{ nft.name }}</p>
  </div>
{% endfor %}

